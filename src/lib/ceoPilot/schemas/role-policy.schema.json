{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "RolePolicy",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "policyId",
    "roleId",
    "roleName",
    "version",
    "jurisdiction",
    "authorityCeiling",
    "deniedActions",
    "escalationRules",
    "chainOfCommand",
    "dataAccess",
    "toolAccess",
    "auditRequirements",
    "createdAt",
    "updatedAt"
  ],
  "properties": {
    "policyId": { "type": "string", "minLength": 1 },
    "roleId": { "type": "string", "minLength": 1 },
    "roleName": { "type": "string", "minLength": 1 },
    "version": { "type": "string", "minLength": 1 },
    "jurisdiction": {
      "type": "object",
      "additionalProperties": false,
      "required": ["domains", "actions"],
      "properties": {
        "domains": { "type": "array", "minItems": 1, "items": { "type": "string" } },
        "actions": { "type": "array", "minItems": 1, "items": { "type": "string" } }
      }
    },
    "authorityCeiling": {
      "type": "object",
      "additionalProperties": false,
      "required": ["maxPermissionTier", "maxTaskClass", "maxImpact", "maxEstimatedCostCents"],
      "properties": {
        "maxPermissionTier": { "type": "string", "enum": ["draft", "suggest", "execute"] },
        "maxTaskClass": { "type": "string", "enum": ["routine", "novel", "high_risk"] },
        "maxImpact": { "type": "string", "enum": ["reversible", "difficult", "irreversible"] },
        "maxEstimatedCostCents": { "type": "integer", "minimum": 0 }
      }
    },
    "deniedActions": { "type": "array", "items": { "type": "string" } },
    "escalationRules": {
      "type": "object",
      "additionalProperties": false,
      "required": ["alwaysEscalateActions", "alwaysEscalateDomains"],
      "properties": {
        "alwaysEscalateActions": { "type": "array", "items": { "type": "string" } },
        "alwaysEscalateDomains": { "type": "array", "items": { "type": "string" } },
        "escalateAboveTaskClass": { "type": "string", "enum": ["routine", "novel", "high_risk"] },
        "escalateAboveImpact": { "type": "string", "enum": ["reversible", "difficult", "irreversible"] },
        "escalateAboveCostCents": { "type": "integer", "minimum": 0 }
      }
    },
    "chainOfCommand": {
      "type": "object",
      "additionalProperties": false,
      "required": ["canRequestFromRoles", "canApproveForRoles"],
      "properties": {
        "canRequestFromRoles": { "type": "array", "items": { "type": "string" } },
        "canApproveForRoles": { "type": "array", "items": { "type": "string" } }
      }
    },
    "dataAccess": {
      "type": "object",
      "additionalProperties": false,
      "required": ["allowedCategories"],
      "properties": {
        "allowedCategories": { "type": "array", "items": { "type": "string" } }
      }
    },
    "toolAccess": {
      "type": "object",
      "additionalProperties": false,
      "required": ["allowedTools", "allowedContracts"],
      "properties": {
        "allowedTools": { "type": "array", "items": { "type": "string" } },
        "allowedContracts": { "type": "array", "items": { "type": "string" } }
      }
    },
    "auditRequirements": {
      "type": "object",
      "additionalProperties": false,
      "required": ["requiredFields"],
      "properties": {
        "requiredFields": { "type": "array", "minItems": 1, "items": { "type": "string" } }
      }
    },
    "createdAt": { "type": "string", "format": "date-time" },
    "updatedAt": { "type": "string", "format": "date-time" }
  }
}
